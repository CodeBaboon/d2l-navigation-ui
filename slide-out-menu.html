<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../vui-colors/colors.html">
<dom-module id="d2l-navigation-slide-out-menu">
	<style include="vui-colors">
		:host {
			display: block;
		}
		.d2l-navigation-slide-out-menu-content {
			background-color: var(--vui-color-white);
			display: none;
			height: 100%;
			left: 0;
			min-width: 300px;
			overflow-y: auto;
			position: fixed;
			top: 0;
			transform: translateX(-100%);
			transition: transform 300ms;
			width: 84%;
			z-index: 200;
		}
		:host-context([dir='rtl']) .d2l-navigation-slide-out-menu-content {
			right: 0;
			transform: translateX(100%);
		}
		:host([state='transition']) .d2l-navigation-slide-out-menu-content,
		:host([state='opened']) .d2l-navigation-slide-out-menu-content {
			display: block;
		}
		:host([state='opened']) .d2l-navigation-slide-out-menu-content {
			transform: translateX(0);
		}
		.d2l-navigation-slide-out-menu-mask {
			background-color: var(--vui-color-ferrite);
			height: 0;
			left: 0;
			opacity: 0;
			overflow: hidden;
			position: fixed;
			transition: opacity 300ms, width 0s 0.3s, height 0s 0.3s;
			top: 0;
			width: 0;
			z-index: 100;
		}
		:host([state='opened']) .d2l-navigation-slide-out-menu-mask {
			height: 100%;
			opacity: 0.8;
			transition: opacity 300ms;
			width: 100%;
		}
	</style>
	<template>
		<div class="d2l-navigation-slide-out-menu-mask"></div>
		<div class="d2l-navigation-slide-out-menu-content">
			<content></content>
		</div>
	</template>
</dom-module>
<script>
	Polymer({
		is: 'd2l-navigation-slide-out-menu',
		properties: {
			state: {
				type: String,
				value: 'closed',
				reflectToAttribute: true
			},
			_opener: Object
		},
		open: function(opener) {

			if (this.state !== 'closed') {
				return;
			}
			this.state = 'transition';

			document.body.style.overflow = 'hidden';
			document.body.style.position = 'fixed';
			document.body.style.width = '100%';
			this._opener = opener;
			this.async(function() { this.state = 'opened'; }.bind(this), 50);

		},
		close: function() {

			if (this.state !== 'opened') {
				return;
			}
			this.state = 'transition';

			document.body.style.overflow = 'auto';
			document.body.style.position = 'static';
			document.body.style.width = 'auto';
			this.async(function() { this.state = 'closed'; }.bind(this), 350);

			if (this._opener) {
				this._opener.focus();
				this._opener = null;
			}

		}
	});
</script>
